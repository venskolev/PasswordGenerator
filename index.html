<!-- –§–∞–π–ª: /index.html -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">

  <!-- Responsive -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- SEO -->
  <meta name="description" content="Modern and secure password generator for creating strong passwords instantly.">

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#2fb6a6">
  <link rel="icon" type="image/png" href="/icons/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg" />
  <link rel="shortcut icon" href="/icons/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png" />

  <title>Password Generator | SecurePass</title>

  <link rel="stylesheet" href="/style/style.css">

</head>

<body>
  <!-- Mobile install banner (shown only when not installed) -->
  <div class="install-banner" id="installBanner" role="region" aria-label="Install SecurePass">
    <div class="install-banner__text" id="installBannerText">
      Install SecurePass for quick access.
    </div>
    <button class="install-banner__btn" id="installBannerBtn" type="button" aria-label="Install SecurePass">
      Install
    </button>
    <button class="install-banner__close" id="installBannerClose" type="button" aria-label="Close install banner">
      ‚úï
    </button>
  </div>

  <!-- Animated background -->
  <div class="bg-animation" aria-hidden="true">
    <div class="bg-circle"></div>
    <div class="bg-circle"></div>
    <div class="bg-circle"></div>
  </div>

  <div class="container">
    <!-- Header with Install button -->
    <header class="app-header" role="banner">
      <h2 class="app-logo" aria-label="SecurePass">SecurePass</h2>

      <!-- Desktop install button (hidden on mobile) -->
      <button id="installBtn" class="btn btn-secondary" type="button" aria-label="Install SecurePass app" disabled>
        ‚ûï Install App
      </button>
    </header>

    <div class="card">
      <div class="header">
        <h1>üîê Password Generator</h1>
        <p>Create a strong and secure password for your accounts</p>
      </div>

      <div id="animation-container" aria-live="polite"></div>

      <div class="password-display" id="passwordDisplay" tabindex="0" role="button"
        aria-label="Generated password. Click to copy.">
        <div class="password-text password-placeholder" id="passwordText">
          Click ‚ÄúGenerate‚Äù to create a password
        </div>
      </div>

      <div class="strength-indicator" id="strengthIndicator" aria-live="polite">
        <div class="strength-bar">
          <div class="strength-fill" id="strengthFill"></div>
        </div>
        <div class="strength-text" id="strengthText"></div>
      </div>

      <div class="options" id="options">
        <div class="option-group">
          <label class="option-label">
            Password length: <span class="slider-value" id="lengthValue">16</span>
          </label>
          <input type="range" min="8" max="32" value="16" class="slider" id="lengthSlider" aria-label="Password length">
        </div>

        <div class="option-group">
          <label class="option-label">Include:</label>
          <div class="checkboxes">
            <div class="checkbox-item">
              <input type="checkbox" id="uppercase" checked>
              <label for="uppercase">Uppercase letters (A‚ÄìZ)</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="lowercase" checked>
              <label for="lowercase">Lowercase letters (a‚Äìz)</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="numbers" checked>
              <label for="numbers">Numbers (0‚Äì9)</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="symbols" checked>
              <label for="symbols">Symbols (!@#$%)</label>
            </div>
          </div>
        </div>
      </div>

      <div class="buttons">
        <button class="btn btn-primary" id="generateBtn" type="button">
          <span>‚ú®</span> Generate
        </button>
        <button class="btn btn-secondary" id="copyBtn" type="button" style="display: none;">
          <span>üìã</span> Copy
        </button>
        <button class="btn btn-secondary" id="reloadBtn" type="button" style="display: none;">
          <span>üîÑ</span> New Password
        </button>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer" role="contentinfo">
      <p class="footer-text">
        ¬© <span id="currentYear">2025</span> Secure-Pass by WebDigiTech ‚Äî All rights reserved.<br>
        Contact: <a href="mailto:info@secure-pass.app">info@secure-pass.app</a> ‚Ä¢
        <a href="mailto:support@webdigitech.de">support@webdigitech.de</a>
      </p>
    </footer>
  </div>

  <div class="notification" id="notification" role="status" aria-live="polite">
    <span class="notification-icon" id="notificationIcon" aria-hidden="true"></span>
    <span class="notification-text" id="notificationText"></span>
  </div>

  <script src="/js/script.js"></script>

  <script>
    // Update footer year automatically
    (function () {
      var yearEl = document.getElementById("currentYear");
      if (yearEl) yearEl.textContent = String(new Date().getFullYear());
    })();

    // Register Service Worker for PWA installability
    (function () {
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", function () {
          navigator.serviceWorker.register("/sw.js").catch(function (err) {
            console.warn("[SecurePass] Service Worker registration failed:", err);
          });
        });
      }
    })();

    // Install UX:
    // - Desktop: show header button when installable
    // - Mobile: hide header button, show top banner if not installed
    (function () {
      var installBtn = document.getElementById("installBtn");
      var banner = document.getElementById("installBanner");
      var bannerBtn = document.getElementById("installBannerBtn");
      var bannerText = document.getElementById("installBannerText");
      var bannerClose = document.getElementById("installBannerClose");

      var deferredPrompt = null;

      function isStandalone() {
        return window.matchMedia("(display-mode: standalone)").matches ||
          window.navigator.standalone === true;
      }

      function isMobileDevice() {
        return window.matchMedia("(pointer: coarse)").matches ||
          window.matchMedia("(max-width: 768px)").matches;
      }

      function isIOS() {
        return /iphone|ipad|ipod/i.test(window.navigator.userAgent);
      }

      function hide(el) {
        if (!el) return;
        el.style.display = "none";
      }

      function show(el) {
        if (!el) return;
        el.style.display = "flex";
      }

      function setInstalledStateDesktop() {
        if (!installBtn) return;
        installBtn.disabled = true;
        installBtn.textContent = "‚úì Installed";
        installBtn.setAttribute("aria-label", "SecurePass is installed");
      }

      function setDesktopInstallable() {
        if (!installBtn) return;
        installBtn.disabled = false;
        installBtn.textContent = "‚ûï Install App";
        installBtn.setAttribute("aria-label", "Install SecurePass app");
      }

      function showMobileBannerInstallable() {
        if (!banner || !bannerBtn || !bannerText) return;
        bannerText.textContent = "Install SecurePass for quick access.";
        bannerBtn.textContent = "Install";
        bannerBtn.disabled = false;
        show(banner);
      }

      function showMobileBannerIOSHint() {
        if (!banner || !bannerBtn || !bannerText) return;
        bannerText.textContent = "To install: tap Share and choose ‚ÄúAdd to Home Screen‚Äù.";
        bannerBtn.textContent = "OK";
        bannerBtn.disabled = true;
        show(banner);
      }

      function closeBanner() {
        hide(banner);
      }

      // Close banner
      if (bannerClose) {
        bannerClose.addEventListener("click", closeBanner);
      }

      // If already installed -> hide everything install-related
      if (isStandalone()) {
        setInstalledStateDesktop();
        hide(banner);
        return;
      }

      var isMobile = isMobileDevice();

      // Mobile: hide desktop button always
      if (isMobile) {
        hide(installBtn);

        // iOS has no beforeinstallprompt; show hint banner
        if (isIOS()) {
          showMobileBannerIOSHint();
        }
      }

      // beforeinstallprompt fires on supported browsers (mostly Chromium)
      window.addEventListener("beforeinstallprompt", function (e) {
        e.preventDefault();
        deferredPrompt = e;

        if (isMobile) {
          showMobileBannerInstallable();
        } else {
          setDesktopInstallable();
        }
      });

      // Desktop button click
      if (installBtn) {
        installBtn.addEventListener("click", async function () {
          if (!deferredPrompt) return;

          deferredPrompt.prompt();
          try {
            var choice = await deferredPrompt.userChoice;
            if (choice && choice.outcome === "accepted") {
              setInstalledStateDesktop();
            }
          } catch (err) {
            console.warn("[SecurePass] Install prompt error:", err);
          } finally {
            deferredPrompt = null;
          }
        });
      }

      // Mobile banner click
      if (bannerBtn) {
        bannerBtn.addEventListener("click", async function () {
          if (!deferredPrompt) return;

          deferredPrompt.prompt();
          try {
            var choice = await deferredPrompt.userChoice;
            if (choice && choice.outcome === "accepted") {
              closeBanner();
            }
          } catch (err) {
            console.warn("[SecurePass] Install prompt error:", err);
          } finally {
            deferredPrompt = null;
          }
        });
      }

      window.addEventListener("appinstalled", function () {
        setInstalledStateDesktop();
        closeBanner();
        deferredPrompt = null;
      });
    })();
  </script>

</body>

</html>
